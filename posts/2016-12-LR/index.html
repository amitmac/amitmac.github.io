<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
    <head>
        <title>Linear Regression - About Learning</title>
		<meta charset="utf-8">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <!--mobile first-->
        <meta name="viewport" content="width=device-width, initial-scale=1.0">

        <!--removed html from url but still is html-->
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <link href="http://amitmac.github.io/posts/2016-12-LR/" rel="canonical" />
        <link rel="shortcut icon" href="../../images/favicon.ico">
        <link rel="stylesheet" type="text/css" href="../../jquery-ui-1.11.4/jquery-ui.css">
        <link rel="stylesheet" href="../../bootstrap/css/bootstrap.css">
        <link href="../../font-awesome/css/font-awesome.css" rel="stylesheet">
        <link href="../../css/sticky-footer-navbar.css" rel="stylesheet">
        <!--<link rel="stylesheet" href="../../css/default.css">-->
        <link rel="stylesheet" href="../../css/style.css">

        <link href="../../highlight/styles/github.css" rel="stylesheet">

        <link rel="stylesheet" href="../../highlight/styles/default.css">
        <script src="../../highlight/highlight.pack.js"></script>
        <script>hljs.initHighlightingOnLoad();</script>

        <script type="text/x-mathjax-config">
            MathJax.Hub.Config({tex2jax: {
                                    inlineMath: [['$','$'], ['\\(','\\)']]
                                },
                                CommonHTML: {
                                    scale: 100
                              }});
        </script>
        <script type="text/javascript" src="../../js/jquery-2.0.2.min.js"></script>
        <script type="text/javascript" src="../../jquery-ui-1.11.4/jquery-ui.js"></script>
        <script type="text/javascript" src="../../bootstrap/js/bootstrap.min.js"></script>
        <script type="text/javascript" src="../../js/script.js"></script>

        <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script>
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

            ga('create', 'UA-65608932-1', 'auto');
            ga('send', 'pageview');
        </script>
    </head>
    <body class="blog">
        <div id="">
            <nav class="navbar navbar-inverse navbar-static-top" role="navigation">
                <div class="container">
                    <!--Toggle header for mobile-->
                    <div class="navbar-header">
                        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                            <span class="sr-only">Toggle navigation</span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                        </button>
                        <a class="navbar-brand active" href="../../index.html" id="home">ABOUT LEARNING</a>
                    </div>
                    <!--normal header-->
                    <div class="navbar-collapse collapse">
                        <ul class="nav navbar-nav navbar-right">
                            <li><a href="../../index.html"><span class="glyphicon glyphicon-pencil"></span>  Blog</a></li>
                            <li><a href="../../about.html"><span class="glyphicon glyphicon-user"></span>  About</a></li>
                        </ul>
                    </div><!--/.nav-collapse -->
                </div>
            </nav>
            <div class="content">
                <div class="container">
                    <div class="row">
                        <div class="col-md-8 col-md-offset-2">
                            <h2>Linear Regression</h2>
                            <hr>
                            <p>Perceptron Learning Algorithm is basically a classification algorithm. Here by regression we mean that we’d have to predict real valued output not just +1/-1 or 0/1.</p>

<p><b>Linear regression</b> is study of relationship between a scalar dependent variable y and one or more explanatory variables or features denoted by X. If there is only one feature, we say it is simple linear regression else for more than one, we say it is multiple linear regression.In linear regression, data is modeled using linear predictor functions, and unknown model parameters are estimated from the data. Such models are called <i>linear models</i>. Here our goal is prediction or forecasting. We’ll try to fit the predictive model to a dataset of y and X values. After developing such model, if an additional value of X is given without its y value, the model can be used to make predictions of the y value.</p>

<p><b>Notation: </b></p>
<p>$ m $ - number of training examples</p>
<p>$ X $ - input variables</p>
<p>$ y $ - output variable</p>
<p>$ (x^i,y^i) $ - i-th training example</p>

<p>
The prediction equation is called hypothesis. In linear model, hypothesis is of the form $ h_\theta(x) = \theta_0 + \theta_1x $, where $ \theta_0 $ and $ \theta_1 $ are the parameters to be estimated. We’ll introduce $ x_0=1 $ as a new feature to make our hypothesis $ h_\theta(x) = \theta^Tx $ . $ h_\theta(x) $ is the predicted output where $ y $ is the original output. We have to minimize the error between the two, $ h_\theta(x)$ and $ y $.
</p>
<div class="row top-buffer">
    <div class="col-md-8 col-md-offset-4">
        <div class="post">
            <img class="aligncenter" src="images/linear-reg-2.png" alt="linear regression" />
        </div>
    </div>
</div>
<p>
The error function is given by the squared error function which is given by 
<p style="text-align:center;">$ J(\theta_0, \theta_1) = (\frac{1}{2m}) \sum_{i=1}^{m}(h_\theta(x^i) - y^i)^2 $</p> 
To minimize the error function $ J $<strong> </strong>we'd have to adjust $ \theta_0 $  and $ \theta_1 $ so that $ h_\theta(x) $ is close to y.<strong> </strong>
</p>

<p>Outline for minimization:</p>
<ul>
	<li>Start with some $ \theta_0 $ and $ \theta_1 $</li>
	<li>Keep changing them  to reduce $ J(\theta_0, \theta_1) $ until we get minimum value.</li>
</ul>
<div class="row top-buffer">
    <div class="col-md-8 col-md-offset-2">
        <img class="aligncenter" src="images/linear-theta-update.png" height="200px" alt="linear regression" style="margin-left:100px;"/>
    </div>
</div>
To implement above steps we use Gradient Descent Algorithm which a simple equation. We repeat the following step until the convergence:
<p style="text-align:center;">$ \theta_j = \theta_j - \alpha \frac{\partial }{\partial \theta_0} J(\theta_0, \theta_1) $ , for $ j=0 $ and $ j=1 $</p>
<b>Note:</b>
<ul>
	<li>$ \theta_0 $ and $ \theta_1 $ should be simultaneously updated.</li>
	<li>$ \alpha $ is learning rate. It should neither be too small nor too big. If it is small, it can make the algorithm slower. If too big, it may fail to minimize.</li>
</ul>
On differentiating squared error function (also called cost function) and putting the value of  $ h_\theta(x) $, we get -
<p style="text-align:center;">$ \theta_j = \theta_j - \frac{\alpha}{m} \sum_{i=0}^{m}(\theta^Tx^i - y^i) x^i $ , for $ j=0 $ and $ j=1 $</p>
Lets see now how to implement it using MATLAB,

Remember how $ y $ and$ X $ data is,
<p style="text-align:center;">$ y = \begin{bmatrix} y_1\\ y_2\\ .\\ .\\ y_n\\ \end{bmatrix}$, $ X = \begin{bmatrix} 1& x_1 \\ 1& x_2\\ .&.\\ .&.\\ 1& x_n\\ \end{bmatrix}$ , $ \theta = \begin{bmatrix} \theta_0 \\ \theta_1 \\ \end{bmatrix}$</p>
The matrices X and theta should be multiplied by care. <em>data1.txt</em> file contains two columns. First is the feature and the other is the target values or output.

<pre><code class="MATLAB">
data = load('data1.txt');
X = data(:, 1); y = data(:, 2);
m = length(y); % number of training examples
X = [ones(m, 1), data(:,1)]; % Add a column of ones to x
theta = zeros(2, 1); % initialize fitting parameters

% Some gradient descent settings
iterations = 1500;
alpha = 0.01;

% compute and display initial cost
computeCost(X, y, theta); %function described below
theta = gradientDescent(X, y, theta, alpha, iterations); % theta contains value of theta0 and theta1
predict1 = [1, 3.5] *theta; %predict for new data
</code></pre>

Compute Cost function

<pre><code class="MATLAB">
function J = computeCost(X, y, theta)
    m = length(y); % number of training examples
    J = 0;
    J = sum((X*theta - y).^2)/(2*m);
end
</code></pre>

Gradient Descent function

<pre><code class="MATLAB">
function [theta, J_history] = gradientDescent(X, y, theta, alpha, num_iters)
    % Initialize some useful values
    m = length(y); % number of training examples
    J_history = zeros(num_iters, 1);

    % the number of features
    n = size(X, 2);

    for iter = 1:num_iters
        theta = theta - (alpha / m) * (X' * (X * theta - y));

        % Save the cost J in every iteration
        J_history(iter) = computCost(X,y,theta);
    end

end
</code></pre>

                        </div>  
                    </div>
                    <div class="row">
                        <div class="col-md-8 col-md-offset-2">
                            <div id="disqus_thread"></div>
                            <script>
                                /**
                                 *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
                                 *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables
                                 */
                                
                                var disqus_config = function () {
                                    this.page.url = "http://amitmac.github.io/posts/2016-12-LR/";  // Replace PAGE_URL with your page's canonical URL variable
                                    this.page.identifier = "/posts/2016-12-LR/"; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
                                };

                                (function() {  // DON'T EDIT BELOW THIS LINE
                                    var d = document, s = d.createElement('script');
                                    
                                    s.src = '//amitmac-1.disqus.com/embed.js';
                                    
                                    s.setAttribute('data-timestamp', +new Date());
                                    (d.head || d.body).appendChild(s);
                                })();
                            </script>
                            <noscript>
                                Please enable JavaScript to view the 
                                <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a>
                            </noscript>
                        </div>
                    </div>         
                </div>
            </div>
        </div>
    <script id="dsq-count-scr" src="//amitmac-1.disqus.com/count.js" async></script>
    </body>
</html>
